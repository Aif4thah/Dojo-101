# Web


## burp & Zap (crawl + discovery)

* [ZAP](https://www.zaproxy.org/)
* [Burp](https://portswigger.net/burp)

Utiliser la documentation et l'interface graphique :

* Découverte manuelles via navigateur + proxy
* Spider
* Fuzzer

## webservices (sous domaines DNS et virtual host)

```bash
nmap -p 80 --script dns-brute.nse vulnweb.com 
```

## vitual hosts:

```bash
nmap -p 80 --script hostmap-bfk.nse nmap.org 
```

## enum folders

```bash
nmap --script http-enum 192.168.10.55
nmap --script -http-enum --script-args http-enum.basepath='pub/' 192.168.10.55
nmap --script http-title -sV -p 80 192.168.1.0/24
```

## httpx (checks and basics info)

[httpx](https://github.com/projectdiscovery/httpx/releases)

## katana (crawler)

[Katana on Github](https://github.com/projectdiscovery/katana)

```sh
./katana.exe -u <url>
```

## Nuclei

[Nuclei](https://github.com/projectdiscovery/nuclei)

## ffuf (discovery)

[ffuf on Github](https://github.com/ffuf/ffuf)

## Nikto (scanner)

nikto -host htttp://<victim> -p <port> [ -ssl ] [-vhost]

## cewl (list generator)

pour creer des wordlists et énumer le site

## ffuf

utiliser ffuf et les seclists: https://github.com/danielmiessler/SecLists

`apt install ffuf -y`

### repertoire à la racine:

```powershell
ffuf -w /opt/useful/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://SERVER_IP:PORT/FUZZ -v -c

### trouver les extentions acceptées par la cible:

```powershell
ffuf -w /opt/useful/SecLists/recu:FUZZ -u http://SERVER_IP:PORT/blog/indexFUZZ
```

### extension et recursivité (les repertoires son testé quand meme automatiquement):

```powershell
ffuf -w /opt/useful/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://SERVER_IP:PORT/FUZZ -recursion -recursion-depth 1 -e .php,.txt,.zip,.html,.js,.jsp,.txt
```

### find subdomains:

```powershell
ffuf -w /opt/useful/SecLists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u https://FUZZ.hackthebox.eu/
```

### find vhost:

```powershell
ffuf -w /opt/useful/SecLists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://academy.htb:PORT/ -H 'Host: FUZZ.academy.htb' -fs <taille de la réponse à exclure>
```

### find GET parameters:

```powershell
ffuf -w /opt/useful/SecLists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u http://admin.academy.htb:PORT/admin/admin.php?FUZZ=key -fs <taille de la réponse à exclure>
```

### find POST paramaters:

```powershell
ffuf -w ids.txt:FUZZ -u http://admin.academy.htb:PORT/admin/admin.php -X POST -d 'id=FUZZ' -H 'Content-Type: application/x-www-form-urlencoded' -fs <taille de la réponse à exclure>
```

### options ffuf pour logger les résultats

```powershell
-of csv -o ffuf-result.txt
```

(VScode and search expected result)

### Envoyer une requete depuis un fichier RAW (depuis ZAP ou Burp)

```powershell
.\ffuf.exe -request .\vti.raw -w test
```

### options ffuf proxy:

```powershell
-replay-proxy http://127.0.0.1:8888
```

### ffuf + pwsh

```powershell
mkdir resultats -ea silentlycontinue
gc ./urls.txt |%{

    $url = $_
    $log = $url.Replace("://","-").Replace("/","")

    ./ffuf.exe `
    -w ./directory-list-2.3-medium.txt:FUZZ `
    -u  "${url}FUZZ/" `
    -H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0' `
    -of csv `
    -o "./resultats/${log}.csv" `
    -v
}
```

## ffuf avec radamsa

## exemple for testing json:

```powershell
echo '{"cle"="value}' |.\radamsa.exe -n 10
```

## fuff and radamsa (cf. RECON for fuff commands)

```powershell
ffuf -u http://codingo.io/FUZZ -w ./wordlist -replay-proxy http://127.0.0.1:8888
```
##  Generate 1000 example payloads

```powershell
radamsa -n 1000 -o %n.txt example1.txt example2.txt
```

# This results into files 1.txt ... 1000.txt
# Now we can just read the payload data in a loop from file for ffuf

```powershell
ffuf --input-cmd 'cat $FFUF_NUM.txt' -H "Content-Type: application/json" -X POST -u https://ffuf.io.fi/ -mc all -fc 400
```


